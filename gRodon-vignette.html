<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Predicting maximal growth rates with gRodon</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Predicting maximal growth rates with <code>gRodon</code></h1>



<p>The <code>gRodon</code> package allows you to predict the maximal growth rate of a prokaryotic organism from genomic data. For details of how this is done please see the original paper. Briefly, gRodon exploits codon usage statistics to detect optimization of highly-expressed genes, an indicator of selection for rapid growth. We will provide some guidance about when these predictions are appropriate below.</p>
<p>The <code>gRodon</code> package is quite simple, with only a single function currently available to users: <code>predictGrowth()</code>. We provide a simple, easy to use interface that allows any user with a genome in-hand to predict maximal growth rate.</p>
<p>The <code>gRodon</code> approach is largely based on an earlier program, <code>growthpred</code>, developed by <a href="https://doi.org/10.1371/journal.pgen.1000808">Vieira-Silva et al.</a>. <code>gRodon</code> is intended to be:<br />
1. User-friendly (especially for R users)<br />
2. More accurate (due to the incorporation of additional measures of codon usage)<br />
3. More accurate on mixed-organism samples (i.e., metagenomes; due to a correction factor for the relative abundance of different organisms)</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>The easiest way to install gRodon is with <a href="https://github.com/r-lib/devtools">devtools</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co">#install devtools if necessary</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;devtools&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="co">#install gRodon</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;jlw-ecoevo/gRodon2&quot;</span>)</span></code></pre></div>
<p><code>gRodon</code> has a few dependencies - namely the <code>Biostrings</code> and <code>coRdon</code> packages which are bioconductor packages and cannot be installed via CRAN, and the <code>matrixStats</code> package which can be installed via CRAN. To install them run the following:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co">#install bioconductor if necessary</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co">#install dependencies</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;Biostrings&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;coRdon&quot;</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="kw">install.packages</span>(<span class="st">&quot;matrixStats&quot;</span>)</span></code></pre></div>
</div>
<div id="before-you-begin" class="section level2">
<h2>Before You Begin</h2>
<p>There are two things that <code>gRodon</code> does <em>not</em> do that you <em>must</em> do ahead of time yourself in order to predict growth rate:<br />
1. You must identify coding sequences in your genome<br />
(e.g., using <a href="https://github.com/hyattpd/Prodigal">prodigal</a>)<br />
2. You must annotate a set of highly-expressed genes, typically those coding for ribosomal proteins. We usually use genes coding for ribosomal proteins as our highly-expressed set since these are universal across microbes and almost always highly expressed (if you wanna grow you gotta make proteins), but if you have expression data for your organism you might be able to tailor an even better set of highly expressed genes.</p>
<p>It is helpful if (in frame) coding sequences are stored in a fasta file for easy loading. Additionally, you will need to have a logical vector describing which genes are part of your highly expressed set (this should become a bit clearer with the examples below).</p>
<div id="a-tiny-detour-annotating-your-assembly" class="section level5">
<h5>A Tiny Detour: Annotating Your Assembly</h5>
<p>I’ll lead you through one way to get annotated coding sequence to input into gRodon here, but there are many (MANY) ways to do this. For example, check out this set of tutorials on <a href="https://github.com/biovcnet/biovcnet.github.io/wiki/TOPIC%3A-Functional-Annotation">functional annotation</a>.</p>
<p><strong>Disclaimer:</strong> <em>I make no claim that this is the best, most efficient, or most graceful way to get annotated coding sequences from your assembly, but it will get the job done. If you have strong opinions about how this should be done shoot me an email and I will be happy to link to your rant/tutorial. If you already have annotated coding sequences please skip this section. If you have unannotated CDS (e.g., from <a href="https://github.com/hyattpd/Prodigal">prodigal</a>), you might consider simply BLASTing your output for highly expressed genes (e.g., using the blastdb of ribosomal proteins included in <a href="http://ftp.pasteur.fr/pub/gensoft/projects/growthpred/">growthpred</a>).</em></p>
<p>Given an un-annotated genome or metagenomic assembly, an easy way to find and annotate coding sequence is using the program <a href="https://github.com/tseemann/prokka">prokka</a>. For example, if I have a set of assembled contigs, I could run (on the command line):</p>
<pre><code>prokka contig.fasta --prefix my_genome</code></pre>
<p>This will give several output files. You are interested the untranslated coding sequences (CDS), which can be found in the <code>*.ffn</code> file along with other non-coding transcripts (e.g., rRNA, tRNA). To get the names of just your CDS you can pull them out of the <code>*.gff</code> output:</p>
<pre><code>sed -n &#39;/##FASTA/q;p&#39; my_genome/my_genome.gff | awk &#39;$3==&quot;CDS&quot;&#39; | awk &#39;{print $9}&#39; | awk &#39;gsub(&quot;;.*&quot;,&quot;&quot;)&#39; | awk &#39;gsub(&quot;ID=&quot;,&quot;&quot;)&#39; &gt; CDS_names.txt</code></pre>
<p>The above command first trims the sequence data off the end of the <code>*.gff</code> file, then looks for rows describing CDS and pulls out their IDs, finally it outputs these IDs to a file called <code>CDS_names.txt</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Load your *.ffn file into R</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(<span class="st">&quot;my_genome/my_genome.ffn&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co"># Subset your sequences to those that code for proteins</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>CDS_IDs &lt;-<span class="st"> </span><span class="kw">readLines</span>(<span class="st">&quot;CDS_names.txt&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>gene_IDs &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; .*&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">names</span>(genes)) <span class="co">#Just look at first part of name before the space</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>genes &lt;-<span class="st"> </span>genes[gene_IDs <span class="op">%in%</span><span class="st"> </span>CDS_IDs]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">#Search for genes annotated as ribosomal proteins</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;ribosomal protein&quot;</span>,<span class="kw">names</span>(genes),<span class="dt">ignore.case =</span> T)</span></code></pre></div>
<p>You are now ready to run gRodon.</p>
</div>
</div>
<div id="a-minimal-example" class="section level2">
<h2>A Minimal Example</h2>
<p>We have included an example genome assembly with this package, downloaded from NCBI’s RefSeq database (<em>Streptococcus pyogenes</em> M1, GCF_000349925.2). This is simply a fasta file with the predicted coding sequences and annotations for this genome (provided by NCBI).</p>
<p>Let’s load this file using the <code>readDNAStringSet()</code> function from the <code>Biostrings</code> package (required for <code>gRodon</code> to work).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">library</span>(gRodon)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">library</span>(Biostrings)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co">#This just creates a string with the path of the example genome from the gRodon package</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>path_to_genome &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>  <span class="st">&#39;GCF_000349925.2_ASM34992v2_cds_from_genomic.fna.gz&#39;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="co">#Load the genome into your R environment</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(path_to_genome)</span></code></pre></div>
<p>We also need a set of highly expressed genes. In general, the ribosomal proteins are a good set of genes to use for this purpose. Since these proteins should already be annotated in our example file (try running <code>names(genes)</code> to see the annotations from NCBI) we can use <code>grep()</code> to search for them (specifically, <code>grepl()</code> to return a logical vector).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;ribosomal protein&quot;</span>,<span class="kw">names</span>(genes),<span class="dt">ignore.case =</span> T)</span></code></pre></div>
<p>And now we are ready to predict the maximal growth rate of <em>S. pyogenes</em> M1.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="co">#&gt; There were 146 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9148924</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5062119</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a><span class="co">#&gt; [1] -0.3886505</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a><span class="co">#&gt; [1] 146</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a><span class="co">#&gt; [1] 45</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2987448</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2349466</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3830901</span></span></code></pre></div>
<p>The warning at the top is letting you know that there were a number of genes in your fasta that either weren’t a length multiple of three, or were under the length threshold of 80 codons (240 bp) where estimates of bias will be unreliable. Don’t worry about this unless the number of filtered genes is very high compared to the total number of genes in your file. We expect some genes to typically get filtered.</p>
<p>The output contains several (hopefully) useful quantities:</p>
<ul>
<li><code>$CUBHE</code> is the mean of the codon usage bias of each highly expressed gene relative to all other genes</li>
<li><code>$ConsistencyHE</code> is the mean of the codon usage bias of each highly expressed gene relative to all other highly expressed genes</li>
<li><code>$CPB</code> is the genome-wide codon pair bias</li>
<li><code>$FilteredSequences</code> is the number of sequences filtered due to length</li>
<li><code>$d</code> is the estimated minimal doubling time from <code>gRodon</code> in hours. This is, presumably, what you came here for.</li>
<li><code>$LowerCI</code> and <code>$UpperCI</code> are the 95% confidence intervals for <code>d</code></li>
</ul>
<p>For details on how each of these is calculated please see the <code>gRodon</code> paper. For most users the only outputs that will matter much to you are <code>$d</code>, <code>$LowerCI</code>, and <code>$UpperCI</code>, which are your estimated minimal doubling times and 95% CIs output by the gRodon model.</p>
<p>For the most part, that’s all you need to know. There are a few specific use cases we discuss below that require a slightly more thoughful application of <code>gRodon</code>. These are:</p>
<ul>
<li>The use of partial genomic data (e.g., incomplete SAGs or MAGs)<br />
</li>
<li>The use of metagenomic data (<strong>if using metagenomes you MUST use metagenome mode or risk getting some very strange results</strong>)</li>
<li>Predicting maximal growth rates when maximal growth is very slow<br />
</li>
<li>Predicting the maximal growth rate of a psychrophile or thermophile<br />
</li>
<li>Predicting the maximal growth rates of microbial eukaryotes (gRodon v2)</li>
</ul>
<div id="partial-mode" class="section level3">
<h3>Partial Mode</h3>
<p>What if you don’t have a nice, complete genome (e.g., a SAG or MAG) … can you still use <code>gRodon</code>? Yes, you can, though you may want to use either “partial” or “metagenome” mode.</p>
<p>When your genome is incomplete, you may have insufficient data to accurately estimate the codon pair bias (since there are many possible codon pairs). In this case you can set <code>gRodon</code> to “partial” mode, which excludes pair-bias from the prediction. This is probably a good choice when working with incomplete SAGs and MAGs. The expected decrease in accuracy is quite small (see <code>gRodon</code> paper).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed, <span class="dt">mode=</span><span class="st">&quot;partial&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="co">#&gt; There were 146 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9148924</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5062119</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a><span class="co">#&gt; [1] -0.3886505</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a><span class="co">#&gt; [1] 146</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a><span class="co">#&gt; [1] 45</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a><span class="co">#&gt; [1] 0.3631482</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2840725</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4683562</span></span></code></pre></div>
<p>Anecdotally, some users have noted better results using “metagenome” mode (see below) than “partial” mode on MAGs. This may have to do with contaminated bins, which will cause misleading results with “partial” or “full” modes, but that “metagenome” mode should be fairly robust to. This is because the consistency statistic will not perform well on sequences from a mix of organisms (see below).</p>
</div>
<div id="metagenome-mode" class="section level3">
<h3>Metagenome Mode</h3>
<p>For bulk estimation of the average community-wide maximal growth rate from metagenomes, our consistency statistic is not appropriate, since different organisms may prefer different codons (even when they have similar bias values). It also doesn’t make much sense to calculate the pair-bias in this scenario. Thus the model for predicting the average maximal growth rate of a metagenomic sample excludes consistency and pair-bias. Importantly, metagenome mode is expected to be less accurate than the default mode, so only use this mode if you must (i.e., you have a metagenomic sample).</p>
<p><strong>EVEN MORE IMPORTANTLY - if you have a metagenome (mixed community sample) you MUST use metagenome mode.</strong> Otherwise, gRodon’s consistency statistic will think you have a single organism that has a bunch of highly expressed genes optimized in different ways, and gRodon will severely underestimate your maximal growth rate. If you are getting really long minimal doubling times check to make sure you are using metagenome mode.</p>
<p>Let’s try this on one of the samples from <a href="https://doi.org/10.7554/eLife.49816">Okie et al.</a>, as discussed in the <code>gRodon</code> manuscript:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>path_to_metagenome &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>  <span class="st">&#39;ERR2143764_fastp_prokka_scaffolds.ffn.gz&#39;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(path_to_metagenome)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;ribosomal protein&quot;</span>,<span class="kw">names</span>(genes),<span class="dt">ignore.case =</span> T)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed, <span class="dt">mode =</span> <span class="st">&quot;metagenome&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a><span class="co">#&gt; Warning in predictGrowth(genes, highly_expressed, mode = &quot;metagenome&quot;): Provide</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a><span class="co">#&gt; depth_of_coverage for your ORFs for a more realistic average community growth</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a><span class="co">#&gt; rate</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a><span class="co">#&gt; There were 8290 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a><span class="co">#&gt; [1] 0.7435671</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6749404</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a><span class="co">#&gt; [1] -0.2902042</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a><span class="co">#&gt; [1] 8290</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a><span class="co">#&gt; [1] 106</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a><span class="co">#&gt; [1] 1.568009</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a><span class="co">#&gt; [1] 1.321773</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a><span class="co">#&gt; [1] 1.868001</span></span></code></pre></div>
<p>You may also want to incorporate a correction for the relative abundance of different organisms in this calculation (e.g., weighted metagenome mode) by specifying the <code>depth_of_coverage</code> option. This should lead to more realistic estimates of the average community-wide maximal growth rate. To use this correction provide <code>depth_of_coverage</code> as a vector of mean depths of coverage for each gene. It does not matter if these coverages are normalized since we only care about relative coverage.</p>
<p>First let’s take a look at our read depths:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>path_to_coverage &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>  <span class="st">&#39;ERR2143764_fastp_map2ffn_counts.tsv&#39;</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>read_depths &lt;-<span class="st"> </span><span class="kw">read.delim</span>(path_to_coverage,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>                            <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>depths &lt;-<span class="st"> </span>read_depths<span class="op">$</span>meandepth</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="co">#Make sure in the correct order</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="kw">names</span>(depths) &lt;-<span class="st"> </span>read_depths<span class="op">$</span>X.rname</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>depth_of_coverage &lt;-<span class="st"> </span>depths[<span class="kw">gsub</span>(<span class="st">&quot; .*&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="kw">names</span>(genes))]</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a><span class="kw">head</span>(depth_of_coverage)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a><span class="co">#&gt; PNFGHFNJ_00001 PNFGHFNJ_00002 PNFGHFNJ_00003 PNFGHFNJ_00004 PNFGHFNJ_00005 </span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a><span class="co">#&gt;        19.3492        35.1459        32.5432        28.4502        27.3811 </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a><span class="co">#&gt; PNFGHFNJ_00006 </span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a><span class="co">#&gt;        29.4147</span></span></code></pre></div>
<p>And now let’s run weighted metagenome mode:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>              highly_expressed, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>              <span class="dt">mode =</span> <span class="st">&quot;metagenome&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>              <span class="dt">depth_of_coverage =</span> depth_of_coverage)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a><span class="co">#&gt; There were 8290 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a><span class="co">#&gt; [1] 0.6999671</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true"></a><span class="co">#&gt; [1] 8290</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true"></a><span class="co">#&gt; [1] 106</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true"></a><span class="co">#&gt; [1] 2.16715</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true"></a><span class="co">#&gt; [1] 1.847755</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true"></a><span class="co">#&gt; [1] 2.55112</span></span></code></pre></div>
<p><strong>For those predicting growth from environmental metagenomes, you should probably try including temperature metadata.</strong> This is particularly true of environments that are much colder than the ambient or incubated lab conditions most training organisms were grown under (e.g., if you have deep ocean samples, arctic soils, ice cubes from your freezer, etc.). The same is true if you are dealing with really hot environments (e.g., hot springs). See details about these options in the “Psychrophiles and Thermophiles” section below.</p>
</div>
<div id="slow-growers" class="section level3">
<h3>Slow Growers</h3>
<p>All codon-usage based predictors of maximal growth will underestimate minimal doubling times when these doubling times are very long. In other words, these predictors will often indicate that slow-growing microbes are able to grow more quickly than they actually can. See the original paper for a more in-depth discusison, but this is because codon-usage bias tends to plateau at a lower-bound in slow-growers.</p>
<p>What does this mean for you? Well, <code>gRodon</code> can reliably tell you if your microbe grows slowly, but it can’t tell you how slowly. In practice, minimal doubling time predictions appear to be accurate up to 5 hours. If <code>gRodon</code> predicts a doubling time above 5 hours, you can confidently say your microbe grows slowly, but not quite how slowly (minimal doubling times &gt;5hrs tend to be underestimates). In these cases <code>gRodon</code> will even warn you to be careful:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>path_to_genome &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>  <span class="st">&#39;GCF_003253775.1_ASM325377v1_cds_from_genomic.fna.gz&#39;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(path_to_genome)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;ribosomal protein&quot;</span>,<span class="kw">names</span>(genes),<span class="dt">ignore.case =</span> T)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true"></a><span class="co">#&gt; There were 780 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true"></a><span class="co">#&gt; Warning in predictGrowth(genes, highly_expressed): Estimated doubling time</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true"></a><span class="co">#&gt; &gt;5 hours. CUB signal saturates at approx. 5 hrs... gRodon may underestimate</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true"></a><span class="co">#&gt; doubling times above this range. Consider simply reporting as &#39;&gt;5hrs&#39;. (In other</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true"></a><span class="co">#&gt; words, this microbe definitely grows slowly, but we can&#39;t tell you quite how</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true"></a><span class="co">#&gt; slowly).</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5980514</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5630458</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true"></a><span class="co">#&gt; [1] -0.3347875</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true"></a><span class="co">#&gt; [1] 780</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true"></a><span class="co">#&gt; [1] 46</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true"></a><span class="co">#&gt; [1] 19.21814</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true"></a><span class="co">#&gt; [1] 13.00419</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true"></a><span class="co">#&gt; [1] 29.05757</span></span></code></pre></div>
<p>The example above is for a <em>Mycobacterium leprae</em> genome. This organism has a doubling time around 240 hours. So we are off by an order of magnitude, but still well within the “slow grower” range.</p>
</div>
<div id="psychrophiles-and-thermophiles" class="section level3">
<h3>Psychrophiles and Thermophiles</h3>
<p><a href="https://doi.org/10.1371/journal.pgen.1000808">Vieira-Silva et al.</a> showed that codon-usage based maximal growth estimators are sensitive to growth temperature. Thermophiles and psychrophiles showed consistently higher/lower growth rates respectively. We included a temperature correstion factor in <code>gRodon</code> to account for this. We caution that this correction is based on only 31 extremophile species, and that <code>gRodon</code> has primarily been validated on mesophilic organisms.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed, <span class="dt">temperature =</span> <span class="dv">33</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="co">#&gt; There were 780 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="co">#&gt; Warning in predictGrowth(genes, highly_expressed, temperature = 33): Estimated</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a><span class="co">#&gt; doubling time &gt;5 hours. CUB signal saturates at approx. 5 hrs... gRodon may</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a><span class="co">#&gt; underestimate doubling times above this range. Consider simply reporting as</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a><span class="co">#&gt; &#39;&gt;5hrs&#39;. (In other words, this microbe definitely grows slowly, but we can&#39;t</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a><span class="co">#&gt; tell you quite how slowly).</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5980514</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5630458</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a><span class="co">#&gt; [1] -0.3347875</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a><span class="co">#&gt; [1] 780</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a><span class="co">#&gt; [1] 46</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true"></a><span class="co">#&gt; $OGT</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true"></a><span class="co">#&gt; [1] 33</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true"></a><span class="co">#&gt; [1] 18.26009</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true"></a><span class="co">#&gt; [1] 12.66798</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true"></a><span class="co">#&gt; [1] 26.85091</span></span></code></pre></div>
<p>If working with thermophiles or psychrophiles you might consider using <code>gRodon</code>’s alternative training set (below) which includes more extremophiles than the default training set.</p>
</div>
<div id="alternative-training-set-from-madin-et-al." class="section level3">
<h3>Alternative Training Set from <a href="https://doi.org/10.1038/s41597-020-0497-4">Madin et al.</a></h3>
<p>We also include a version of <code>gRodon</code> trained on an alternative set of minimal doubling time estimates from a trait database compiled by <a href="https://doi.org/10.1038/s41597-020-0497-4">Madin et al.</a>. This is a larger training set than the set of minimal doubling times fron <a href="https://doi.org/10.1371/journal.pgen.1000808">Vieira-Silva et al.</a>, though both training sets give very similar results. See the <code>gRodon</code> paper for an in-depth discussion.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a>path_to_genome &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>  <span class="st">&#39;GCF_000349925.2_ASM34992v2_cds_from_genomic.fna.gz&#39;</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(path_to_genome)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;ribosomal protein&quot;</span>,<span class="kw">names</span>(genes),<span class="dt">ignore.case =</span> T)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed, <span class="dt">training_set =</span> <span class="st">&quot;madin&quot;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a><span class="co">#&gt; There were 146 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a><span class="co">#&gt; [1] 0.9148924</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a><span class="co">#&gt; [1] 0.5062119</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a><span class="co">#&gt; [1] -0.3886505</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a><span class="co">#&gt; [1] 146</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a><span class="co">#&gt; [1] 45</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a><span class="co">#&gt; [1] 0.364274</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true"></a><span class="co">#&gt; [1] 0.2976978</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true"></a><span class="co">#&gt; [1] 0.4483901</span></span></code></pre></div>
</div>
<div id="eukaryote-mode" class="section level3">
<h3>Eukaryote Mode</h3>
<p>The newest version of gRodon is capable of predicting growth rates for microbial eukaryotes. For euks, you should use “eukaryote” mode, but otherwise the syntax is the same. Beware that euk growth predictions are very sensitive to temperature, and an optimal growth temperature should always be provided for best results.</p>
<p>For bulk community-wide predictions from eukaryotic genes obtained from a metagenome, the standard “eukaryote” mode will work (i.e., unlike for prokaroytes, the full euk model can be applied to metagenomes).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>path_to_euk &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>  <span class="st">&#39;GCA_015146655.1_ASM1514665v1_genomic.cds.filtered.gz&#39;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>path_to_ribo &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&#39;extdata&#39;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>  <span class="st">&#39;GCA_015146655.1_ASM1514665v1_genomic.riboprot&#39;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a>  <span class="dt">package =</span> <span class="st">&#39;gRodon&#39;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>genes &lt;-<span class="st"> </span><span class="kw">readDNAStringSet</span>(path_to_euk)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>ribogenes &lt;-<span class="st"> </span><span class="kw">readLines</span>(path_to_ribo)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>highly_expressed &lt;-<span class="st"> </span><span class="kw">names</span>(genes) <span class="op">%in%</span><span class="st"> </span>ribogenes</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true"></a><span class="kw">predictGrowth</span>(genes, highly_expressed, <span class="dt">mode =</span> <span class="st">&quot;eukaryote&quot;</span>,<span class="dt">temperature=</span><span class="dv">37</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true"></a><span class="co">#&gt; Warning in filterSeq(genes = genes, highly_expressed = highly_expressed, :</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true"></a><span class="co">#&gt; There were 2872 genes either with lengths not multiples of 3 or not above length</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true"></a><span class="co">#&gt; threshold (default 240bp), these genes have been ignored</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true"></a><span class="co">#&gt; $CUBHE</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true"></a><span class="co">#&gt; [1] 1.067224</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true"></a><span class="co">#&gt; $ConsistencyHE</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true"></a><span class="co">#&gt; [1] 0.829462</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true"></a><span class="co">#&gt; $CPB</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true"></a><span class="co">#&gt; [1] -0.09130314</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true"></a><span class="co">#&gt; $FilteredSequences</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true"></a><span class="co">#&gt; [1] 2872</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true"></a><span class="co">#&gt; $nHE</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true"></a><span class="co">#&gt; [1] 133</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true"></a><span class="co">#&gt; $OGT</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true"></a><span class="co">#&gt; [1] 37</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true"></a><span class="co">#&gt; $d</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true"></a><span class="co">#&gt; [1] 6.230334</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true"></a><span class="co">#&gt; $LowerCI</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true"></a><span class="co">#&gt; [1] 4.703184</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true"></a><span class="co">#&gt; </span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true"></a><span class="co">#&gt; $UpperCI</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true"></a><span class="co">#&gt; [1] 8.240259</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
